//预加载图片
var loader=new ImagesLoader();
         loader.loadImages([
            'btn-l.png',
            'btn-r.png',
            'carpet.png',
            'cloud1.png',
            'cloud2.png',
            'fn-b-flower.png',
            'fn-cloth.png',
            'fn-sepr-flower.png',
            'fn-up-mask.png',
            'girl.png',
            'knock-human.png',
            'main-bg.jpg',
            'main-btn.png',
            'main-title.png',
            'run.png',
            'sakura1.png',
            'sakura2.png',
            'sakura3.png',
            'trans-bg.jpg',
            'img/b-clothes1.png',
            'img/b-clothes2.png',
            'img/b-clothes3.png',
            'img/b-clothes4.png',
            'img/b-clothes5.png',
            'img/b-clothes6.png',
            'img/b-hair1.png',
            'img/b-hair2.png',
            'img/b-hair3.png',
            'img/b-hair4.png',
            'img/b-hair5.png',
            'img/b-hair6.png',
            'img/bg-clothes1.png',
            'img/bg-clothes2.png',
            'img/bg-clothes3.png',
            'img/bg-clothes4.png',
            'img/bg-clothes5.png',
            'img/bg-clothes6.png',
            'img/bg-hair1.png',
            'img/bg-hair2.png',
            'img/bg-hair3.png',
            'img/bg-hair4.png',
            'img/bg-hair5.png',
            'img/bg-hair6.png',
            'img/bg1.jpg',
            'img/bg2.jpg',
            'img/bg3.jpg',
            'img/bg4.jpg',
            'img/bg5.jpg',
            'img/bg6.jpg',
            'img/bg7.jpg',
            'img/bg8.jpg',
            'img/bg9.jpg',
            'img/bm1.png',
            'img/bm2.png',
            'img/bm3.png',
            'img/bmm1.png',
            'img/bmm2.png',
            'img/bmm3.png',
            'img/bride-face.png',
            'img/bridegroom-face.png',
            'img/btn-del.png',
            'img/btn-generate.png',
            'img/btn-resize.png',
            'img/cf1.png',
            'img/cf2.png',
            'img/cf3.png',
            'img/cm1.png',
            'img/cm2.png',
            'img/cm3.png',
            'img/dec1.png',
            'img/dec2.png',
            'img/dec3.png',
            'img/dec4.png',
            'img/dec5.png',
            'img/dec6.png',
            'img/dec7.png',
            'img/dec8.png',
            'img/dec9.png',
            'img/dec10.png',
            'img/dec11.png',
            'img/dec12.png',
            'img/fn-desc.png',
            'img/nav-arrow.png',
            'img/nav-dec.png',
            'img/nav-human.png',
            'img/nav-pet.png',
            'img/nav-place.png',
            'img/pet1.png',
            'img/pet2.png',
            'img/pet3.png',
            'img/pet4.png',
            'img/pet5.png',
            'img/pet6.png',
            'img/thumb-b-clothes1.png',
            'img/thumb-b-clothes2.png',
            'img/thumb-b-clothes3.png',
            'img/thumb-b-clothes4.png',
            'img/thumb-b-clothes5.png',
            'img/thumb-b-clothes6.png',
            'img/thumb-b-hair1.png',
            'img/thumb-b-hair2.png',
            'img/thumb-b-hair3.png',
            'img/thumb-b-hair4.png',
            'img/thumb-b-hair5.png',
            'img/thumb-b-hair6.png',
            'img/thumb-bg-clothes1.png',
            'img/thumb-bg-clothes2.png',
            'img/thumb-bg-clothes3.png',
            'img/thumb-bg-clothes4.png',
            'img/thumb-bg-clothes5.png',
            'img/thumb-bg-clothes6.png',
            'img/thumb-b-hair1.png',
            'img/thumb-b-hair2.png',
            'img/thumb-b-hair3.png',
            'img/thumb-b-hair4.png',
            'img/thumb-b-hair5.png',
            'img/thumb-b-hair6.png',
            'img/thumb-bg-clothes1.png',
            'img/thumb-bg-clothes2.png',
            'img/thumb-bg-clothes3.png',
            'img/thumb-bg-clothes4.png',
            'img/thumb-bg-clothes5.png',
            'img/thumb-bg-clothes6.png',
            'img/thumb-bg-hair1.png',
            'img/thumb-bg-hair2.png',
            'img/thumb-bg-hair3.png',
            'img/thumb-bg-hair4.png',
            'img/thumb-bg-hair5.png',
            'img/thumb-bg-hair6.png',
            'img/thumb-bm1.png',
            'img/thumb-bm2.png',
            'img/thumb-bm3.png',
            'img/thumb-bmm1.png',
            'img/thumb-bmm2.png',
            'img/thumb-bmm3.png',
            'img/thumb-chf1.png',
            'img/thumb-chf2.png',
            'img/thumb-chf3.png',
            'img/thumb-chm1.png',
            'img/thumb-chm2.png',
            'img/thumb-chm3.png',
            'img/thumb-d1.png',
            'img/thumb-d2.png',
            'img/thumb-d3.png',
            'img/thumb-d4.png',
            'img/thumb-d5.png',
            'img/thumb-d6.png',
            'img/thumb-d7.png',
            'img/thumb-d8.png',
            'img/thumb-d9.png',
            'img/thumb-d10.png',
            'img/thumb-d11.png',
            'img/thumb-d12.png',
            'img/thumb-hm1.png',
            'img/thumb-hm2.png',
            'img/thumb-hm3.png',
            'img/thumb-hm4.png',
            'img/thumb-hm5.png',
            'img/thumb-hm6.png',
            'img/thumb-p1.png',
            'img/thumb-p2.png',
            'img/thumb-p3.png',
            'img/thumb-p4.png',
            'img/thumb-p5.png',
            'img/thumb-p6.png',
            'img/thumb-s1.jpg',
            'img/thumb-s2.jpg',
            'img/thumb-s3.jpg',
            'img/thumb-s4.jpg',
            'img/thumb-s5.jpg',
            'img/thumb-s6.jpg',
            'img/thumb-s7.jpg',
            'img/thumb-s8.jpg',
            'img/thumb-s9.jpg',
            'txt.png',
            'fn-up-mask.png',
            'pause.png',
            'play.png',
            'pixels.png',
		 ],'./images/');
         loader.complete(function(){
             console.log('completed');
             $(".loading").hide();
             $(".kv").show();
         });
         loader.process(function(){
             console.log('process'+this.processNum);
             $(".loadingNum").html(this.processNum+'%');
             $(".line").css({"width":37.75/2*this.processNum/100+"rem"});
             if(this.processNum>60){
                 $('.man').css({'visibility':'hidden'})
                 $('.man2').show();
                 $('.woman').show();
             }else{
                $('.man').css({'transform':'translate{'+37.75/2*this.processNum/100+'rem,0}'});
             }
         });
         loader.start();

         //用户点击开始按钮，出现告白页，再出现场景布置页面
         function startMake(){
             $(".kv").hide();
             $(".gb").show();
             //告白页
             $('.text1').show(); 
             $('.text1').addClass('enterText1');
             setTimeout(() => {
                $('.text2').show();
                $('.text2').addClass('enterText2');
             }, 800);
             setTimeout(()=>{
                $('.gb').hide();
                $('.bzcj').show();
             },3000)

         }
         $(".startBtn").bind("touchend",startMake);//给开始按钮绑定事件

         //场景布置隐藏， 尾页显示
         function showHaibao(){
             $('.bzcj').hide();
             $('.wy').show();
         }
         $(".saveBtn").bind("touchend",showHaibao);

         //页卡
         let tab = $('.tab');
         let tCont = $('.tCont');

         tab.each(function(i){
            $(this).click(function(){
                tab.removeClass('selected');
                tCont.removeClass('selected');
                //添加选中的页卡
                tab.eq(i).addClass('selected');
                tCont.eq(i).addClass('selected');
            })
         })

         //场景布置内容

         //创建舞台和默认背景
         const app = new PIXI.Application({
             width:750,
             height:1334,
             transparent:true,
         });

         document.getElementById('stage').appendChild(app.view);
         let bgSpr = new devicePixelRatio.Sprite.fromImage("../images/img/bg1.jsp");
         bgSpr.position.set(0,0);
         bgSpr.width=750;
         bgSpr.height=1334;
         bgSpr.name='bg';
         app.stage.addChild(bgSpr);

         //点击页卡内容

         $('.tabCont li').each(function(i){
            $(this).click(function(){
                //风景0-8
                if((i<=8) && (i>=0)){
                    let n = i+1;
                    app.stage.getChildByName('bg').texture = new PIXI.Texture.fromImage('../images/img/bg'+n+'.jsp')
                }

                //人物9-14 9新郎 12新娘
                if(i==9){

                }
                if(i==12){

                }
                if((i<=14) && (i>12)&& (i<12) && (i>9)){

                }
                //修饰 15-26
                if((i<=26) && (i>=15)){

                }

                //宠物 27-32
                if((i<=32) && (i>=27)){

                }

            })
         });

         //添加不同内容  特别注意：背景图片+人物部分
         function randomPso(){
             return{
                 x:750/2+Math.random()*40,
                 y:1334/2+Math.random()*40,
             }
         }
         let squ = 0;
         //who 0新郎  1新娘  2其他
         function addSpr(who){
             let contaliner = new PIXI.Container();
             container.name='sprite'+squ;
             squ ++;

             let cops = randomPso();
             contaliner.position.set(cops.x, cops.y);
            //边框， 缩放按钮， 清除按钮
            const space = 20;
            const btnSize = 50;

            let borderline = new PIXI.Graphics();
            borderline.name='borderline';
            borderline.lineStyle(1, 0xaaaaaa);
            borderline.position.set(0,0);

            let resizeBtn = new PIXI.Sprite.fromImage('../images/img/btn-resize.png');
            resizeBtn.name = "resizeBtn";
            resizeBtn.width = 50
            resizeBtn.height = 50

            let delBtn = new PIXI.Sprite.fromImage('../images/img/btn-del.png');
            delBtn.name = "delBtn";
            delBtn.width = btnSize
            delBtn.height = btnSize
            //图片精灵组
            let imgContalner = new PIXI.Graphics();
            imgContalner.position.set(space/2,space/2);

            //总精灵组container的宽高， resizeBtn的position.set; delBtn 的 position.set;  imgContainer的name
            if(who == 0){
                //新郎
                const male = [340,681];
                const maleSpace = [340+space, 681+space];
                contaliner.width = maleSpace[0]
                contaliner.height= maleSpace[1]
                contaliner.pivot.set(maleSpace[0]/2, maleSpace[1]/2);

                borderline.drawRoundedRect(0,0);

                borderline.width = maleSpace[0]
                borderline.height= maleSpace[1]

                resizeBtn.position.set(maleSpace[0]-btnSize/2, -btnSize/2 );
                delBtn.position.set(-btnSize/2, maleSpace[1]-btnSize/2);

                imgContalner.name = 'xinlang';

                let mbody = new PIXI.Sprite.fromImage('../images/img/bg-clothesl.png');
                mbody.position.set(0, 148);

                let mface = new PIXI.Sprite.fromImage('../images/img/bridegroom-face.png');
                mface.position.set(135, 2);

                let mhai = new PIXI.Sprite.fromImage('../images/img/bg-hair1.png');
                mhai.position.set(137, 0);

                imgContalner.addChild(mbody);
                imgContalner.addChild(mface);
                imgContalner.addChild(mhai);

            }else if(who == 1){
                //新娘

            }else{
                //其他

            }


            contaliner.addChild(imgContalner);
            contaliner.addChild(borderline);
            contaliner.addChild(resizeBtn);
            contaliner.addChild(delBtn);

             app.stage.addChild(contaliner);
         }
         //拖拽

         //缩放

         //清除

         //生成海报